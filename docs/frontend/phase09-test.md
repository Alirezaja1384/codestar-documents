---
title: Test
description: مبارزه با غول‌های باگ با تست‌نویسی
---

## مقدمه

پروژه‌های بزرگ از قسمت‌های مختلفی تشکیل شده‌اند که گاهی اوقات به یکدیگر وابسته‌اند
و بر حسب نیاز ممکن است بخواهید یکی از این بخش‌ها را تغییر دهید؛
چگونه می‌توانید از صحت کارکرد قسمت‌های وابسته اطمینان حاصل کنید؟
برای پاسخ به این سوال، در این فاز به بررسی راه‌های مختلف تست‌کردن سامانه می‌پردازیم.

-   چه راه‌هایی برای تست‌کردن سامانه وجود دارد؟
-   مزایا و معایب این روش‌ها نسبت به یکدیگر چیست؟
-   در Angular چگونه می‌توان تست نوشت؟
-   چگونه می‌توان فهمید چند درصد از کدهای موجود تست شده‌اند؟

---

## یادگیری

### راه‌های مختلف تست‌کردن سامانه

### Automatic Testing

تست اتوماتیک روشی برای بررسی و ارزیابی کیفیت نرم افزار به صورت خودکار است، به جای اینکه توسط انسان انجام شود. در این روش، از اسکریپت‌ها و ابزارهای مخصوص برای شبیه‌سازی رفتار کاربر و انجام تست‌های مختلف بر روی نرم افزار استفاده می‌شود. مزایای تست اتوماتیک شامل سرعت بالا، دقت زیاد، صرفه‌جویی در زمان و هزینه، و قابلیت تکرارپذیری است. از تست اتوماتیک در مراحل مختلف چرخه عمر نرم افزار، از جمله
Unit Testing، Integration Testing، End-To-End Testing, Performance Testing
و
User Acceptance Testing
می‌توان استفاده کرد. ابزارهای متعددی برای انجام تست اتوماتیک وجود دارد که هر کدام امکانات و ویژگی‌های خاص خود را دارند.

#### Unit Testing

یکی از راه‌های اطمینان از صحت عملکرد پروژه، تست کردن کوچک‌ترین بخش‌های آن است. در تست واحد، به بررسی و سنجش عملکرد درست اجزای بنیادی برنامه مانند توابع، کلاس‌ها و متغیرها می‌پردازیم. تمرکز اصلی این نوع تست بر روی عملکرد داخلی این واحدها است و المان‌هایی مانند ظاهر رابط کاربری یا تجربه کاربر در آن مدنظر قرار نمی‌گیرد. هدف نهایی از تست واحد، شناسایی و رفع ایرادات در مراحل ابتدایی توسعه و تضمین کارکرد صحیح هر واحد به صورت مجزا قبل از ادغام آن در سیستم کلی است. با این روش، می‌توان از بروز مشکلات پیچیده در مراحل نهایی توسعه و صرف هزینه‌های اضافی برای رفع آنها جلوگیری کرد.

#### Integration Testing

ممکن است برنامۀ شما با چند برنامۀ دیگر در ارتباط باشد.
به‌عنوان مثال ممکن است شما قسمت فرانت‌اند یک پروژه را توسعه دهید و برنامه‌نویس دیگری قسمت بک‌اند آن را نوشته باشد.
برای اطمینان از یکپارچگی قسمت‌های مختلف و تعامل مناسب آن‌ها با یکدیگر از
Integration Testing
استفاده می‌کنیم.
Integration Testing
نه تنها به ادغام قسمت‌های فرانت‌اند و بک‌اند از یک پروژه اشاره دارد، بلکه به ادغام اجزای مختلفی که توسط تیم‌های مختلف توسعه داده شده‌اند،
اشاره می‌کند. به عنوان مثال، ممکن است یک برنامه‌نویس قسمت احراز هویت را توسعه دهد، در حالی که برنامه‌نویس دیگری قسمت پرداخت را توسعه می‌دهد
و این تست به اطمینان از اینکه هر دو قسمت با یکدیگر درست کار می‌کنند، می‌پردازد.

#### End-to-End Testing

در روش
E2E
برنامه‌ای می‌نویسیم که تمام عملیاتی که توسط کاربر انجام می‌شود را به ترتیب انجام دهد. این برنامه خود را جای کاربر جا می‌زند و کوچک‌ترین اعمال انسان را نیز طبق یک الگوریتم، خط به خط اجرا می‌کند. این روش نزدیک‌ترین روش به تست دستی است اما متاسفانه احتیاج به منابع زیادی از جمله زمان دارد.

### Manual Testing

درسته که تست اتوماتیک مزایای زیادی داره، اما هنوز هم به تست دستی به عنوان
an integral part of the software development process
نیاز داریم. تسترهای دستی با خلاقیت و قضاوت خودشون میتونن ایراداتی رو پیدا کنن که از چشم تست های اتوماتیک پنهان میمونه. علاوه بر این، تست دستی میتونه برای کاوش عمیق تر نرم افزار، یافتن ایرادات غیرمنتظره و در نهایت ارائه ی محصولی با کیفیت بالا مفید باشه. هرچند که این روش بسیار ساده و قابل‌فهم است اما معایبی دارد:

-   بسیار وقت‌گیر است.
-   پس از مدتی به کاری تکراری و خسته‌کننده تبدیل می‌شود.
-   ممکن است انسان اشتباه کند و متوجه عملکرد اشتباه سامانه نشود.
-   ممکن است انسان فراموش کند و بخشی از سامانه را تست نکند.

#### Performance Testing

تست کارایی یا
Performance Testing
نوعی از تست نرم‌افزار است که با هدف ارزیابی سرعت، پاسخ‌دهی و پایداری یک سیستم تحت بار مشخص انجام می‌شود.
این تست به شناسایی گلوگاه‌ها و مشکلات کارایی سیستم کمک می‌کند. در تست کارایی، معیارهایی مانند زمان پاسخ‌دهی، توان عملیاتی، و استفاده از منابع بررسی می‌شوند
تا اطمینان حاصل شود که سیستم تحت بارهای مختلف به خوبی عمل می‌کند و کارایی مورد انتظار را دارد.

#### User Acceptance Testing (UAT)

تست پذیرش کاربر آخرین مرحله از فرآیند تست نرم‌افزار است که توسط خود کاربران یا نهادهای مشتری انجام می‌شود.
هدف اصلی این تست، اطمینان حاصل کردن از اینکه سیستم یا نرم‌افزار، نیازهای کاربران را به درستی برآورده می‌کند و به صورت مطلوب برای آن‌ها کار می‌کند. تست پذیرش کاربر بر اساس معیارهای مشخصی که از سوی کاربران یا مشتریان تعیین شده‌اند، انجام می‌شود.
این تست شامل اجرای سناریوهای واقعی که کاربران در استفاده روزمره از سیستم دارند، می‌شود تا اطمینان حاصل شود که نرم‌افزار طراحی شده به درستی کار می‌کند و تمامی نیازهای کاربران پاسخ داده می‌شود.

### Testing in Angular

#### End-to-End Testing in Angular

ما برای پیاده‌سازی تست‌های
E2E
از ابزار
Cypress
استفاده می‌کنیم. با استفاده از این ابزار به راحتی می‌توان رفتار کاربر واقعی را با استفاده از کد شبیه سازی کرد و آن را با اجرای تست‌ها به صورت دستی جایگزین کرد.
برای نصب و راه‌اندازی
Cypress
در
Angular
، ابتدا
Cypress
را به عنوان
dev dependency
به پروژه
Angular
خود اضافه کنید. برای این کار، از دستور زیر در ترمینال استفاده کنید:

```shell
ng add @cypress/schematic
```

بعد از اجرای دستور بالا
Cypress
به پروژه اضافه خواهد شد و
config
ها و
script
های مورد نیاز جهت کار با
Cypress
در پروژه ایجاد خواهد شد.

حالا می‌توانید
Cypress
را با اجرای دستور زیر از طریق ترمینال باز کنید:

```shell
npm run cy:open
```

برای آشنایی بیشتر با این مفهوم می‌توانید از لینک‌های زیر استفاده کنید:

-   [Cypress - Cypress Docs](https://docs.cypress.io/)
-   [Testing Angular - Principles of Testing with Cypress](https://testing-angular.com/introduction/)

#### Integration Testing in Angular

Integration Testing
در
Angular
به شما امکان می‌دهد تا صحت و تعامل بین اجزا و ماژول‌های مختلف برنامه‌ را ارزیابی کنید. یکی از ابزارهای محبوب مورد استفاده برای این کار
Testing library
است که برای تست‌هایی که اجزا و تعاملات آن‌ها با یکدیگر مهم هستند، بسیار مناسب است. با استفاده از
Testing Library
می‌توانید عملکرد درست ادغام اجزا را تأیید کنید و مطمئن شوید که برنامه‌ی شما به درستی کار می‌کند.

برای آشنایی بیشتر با این مفهوم می‌توانید از لینک‌های زیر استفاده کنید:

-   [Testing Library - Testing Library Docs](https://testing-library.com/docs/angular-testing-library/intro/)
-   [Tim Deschryver - Get Started with Testing Library](https://timdeschryver.dev/blog/good-testing-practices-with-angular-testing-library)

#### Unit Testing in Angular

خوشبختانه
Angular
به‌صورت پیش‌فرض از
Unit Testing
پشتیبانی می‌کند.
در
Angular
می‌توانید با استفاده از ابزارهای
Karma
و
Jasmine
به نوشتن تست بپردازید.
این تست‌ها برای اطمینان از عملکرد صحیح تمام قسمت‌های سامانه،
اعم از کامپوننت‌ها، سرویس‌ها، توابع و ... می‌توانند مورد استفاده قرار بگیرند.

برای راه‌اندازی این امکان، نیاز به انجام کار خاصی نیست؛
صرفاً کافی است با اجرای دستور زیر در Terminal، تست‌های موجود را اجرا کنید:

```shell
ng test
```

با اجرای دستور بالا یک مرورگر باز خواهد شد که لیستی از تست‌ها را به شما نشان می‌دهد؛
همچنین مشخص می‌کند کدام‌یک از آن‌ها موفق و کدام‌یک ناموفق بوده‌اند.

از آنجایی که سایت
Angular
به‌طور کامل در مورد تست‌نویسی توضیح داده است،
شما را به مطالعۀ مستندات مربوطه دعوت می‌کنیم
و از آوردن مطالب تکراری در این مستند می‌پرهیزیم.

برای آشنایی بیشتر با این مفهوم می‌توانید از لینک‌های زیر استفاده کنید:

-   [Angular - Intro to Testing](https://angular.io/guide/testing)
-   [Angular - Code Coverage](https://angular.io/guide/testing-code-coverage)
-   [Angular - Testing services](https://angular.io/guide/testing-services)
-   [Angular - Basics of Testing Components](https://angular.io/guide/testing-components-basics)
-   [Angular - Component Testing Scenarios](https://angular.io/guide/testing-components-scenarios)

---

### Mocking

زمانی که به تست‌کردن قسمتی از سامانه می‌پردازیم،
ممکن است این قسمت با قسمت‌های دیگر در ارتباط باشد و برای اجرای تست‌ها،
کدهای دیگری احتیاج به اجراشدن داشته باشند که ممکن باشد در عملکرد قسمت فعلی خلل ایجاد کنند.
به‌عنوان مثال فرض کنید بخواهیم سرویسی را تست کنیم که برای انجام عملیاتی احتیاج به فرستادن
Request
به سرور داشته باشد؛
قطعاً منطقی نیست برای اجرای تست‌ها نیاز باشد چندصد میلی‌ثانیه منتظر دریافت پاسخ از سرور باشیم؛
از طرفی ممکن است به هر علتی سرور دچار مشکل شده باشد و نتواند پاسخ درستی به ما برگرداند
و تست‌ها
Fail
شوند.
در چنین مواقعی از
Mocking
استفاده می‌کنیم؛
به‌طوری که یک کلاس یا شیء غیرواقعی می‌سازیم و آن را جای کلاس یا شیء اصلی جا می‌زنیم.

در تست نویسی بیشترین حجم از
Mocking
در
Unit Testing
انجام می‌شود و هر چه به سمت تست‌های بزرگتر مانند
Integration Testing
می‌رویم از حجم
Mocking
کاسته می‌شود و از پیاده‌سازی‌های واقعی استفاده می‌شود تا اینکه در
E2E Testing
فرایند
Mocking
کاملا حذف می‌شود.

برای آشنایی بیشتر با این مفهوم می‌توانید از لینک زیر استفاده کنید:

-   [Medium - TIL: Mocking localStorage and sessionStorage in Angular Unit Tests](https://armno.medium.com/til-mocking-localstorage-and-sessionstorage-in-angular-unit-tests-a765abdc9d87)

#### Mocking in Angular

در
Angular
فرایند
Mocking
شامل
component، service، directive
و ... می‌شود که برای اطلاعات بیشتر درباره آن می‌توانید از لینک‌های زیر استفاده کنید:

-   [Jasmine - Spies](https://jasmine.github.io/api/5.1/Spy)
-   [ngMock - Mocking Services](https://ng-mocks.sudo.eu/api/MockService)
-   [ngMock - Mocking Directives](https://ng-mocks.sudo.eu/api/MockDirective)
-   [ngMock - Mocking Components](https://ng-mocks.sudo.eu/api/MockComponent)
-   [Daniel Cornock -Component Stub](https://www.danielcornock.co.uk/articles/angular-testing-3-stubbing-child-components)
-   [Testing Angular - Faking Dependencies](https://testing-angular.com/faking-dependencies/#faking-dependencies)
-   [Testing Angular - Testing Component With Children](https://testing-angular.com/testing-components-with-children/)

---

## پروژه

برای تمام کامپوننت‌ها و سرویس‌های پروژۀ خود
Unit Test
بنویسید
و مطمئن شوید حداقل 80درصد کدها تست شده باشند.

از هر دو عضوِ یکی از تیم‌ها درخواست کنید تا کد شما را جداگانه
Review
کنند؛
بعد از اینکه
Approve
کردند، به منتور عادی مراجعه کنید
و پس از
Approve
او، به منتور سنیور بگویید تا کد شما را ببیند.

همچنین لازم است شما هم حداقل کد یک تیم دیگر را
Review
کنید.
سعی کنید تمام مواردی که در این فاز یاد گرفتید را هنگام
Review
مورد بررسی قرار دهید.
